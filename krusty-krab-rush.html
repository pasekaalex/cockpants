<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Krusty Krab Order Rush | $COCKPANTS</title>
  
  <!-- Leaderboard System -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="leaderboard.js"></script>
  
  <style>
    @font-face {
      font-family: 'Krabby Patty';
      src: url('Krabby Patty.ttf') format('truetype');
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Krabby Patty', Arial, sans-serif;
      overflow: hidden;
      background: linear-gradient(180deg, #8B4513 0%, #654321 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 0;
    }
    
    .game-container {
      display: flex;
      gap: 15px;
      max-width: 1600px;
      width: 100%;
      padding: 15px;
      height: 100vh;
      box-sizing: border-box;
    }
    
    .left-section {
      flex: 0 0 300px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      overflow-y: auto;
      max-height: calc(100vh - 30px);
    }
    
    .center-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 15px;
      min-width: 0;
    }
    
    .right-section {
      flex: 0 0 280px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .panel {
      background: rgba(255, 255, 255, 0.95);
      border: 4px solid #8B4513;
      border-radius: 15px;
      padding: 15px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
    }
    
    .panel-title {
      font-size: 20px;
      color: #FF6B6B;
      text-shadow: 2px 2px 0 #000;
      margin-bottom: 12px;
      text-align: center;
      border-bottom: 3px solid #FF6B6B;
      padding-bottom: 8px;
    }
    
    /* Customer Queue */
    .customer-queue {
      flex: 1;
      overflow-y: auto;
    }
    
    .customer-card {
      background: linear-gradient(135deg, #FFE4B5, #FFD700);
      border: 3px solid #FF8C00;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 12px;
      position: relative;
      animation: slideIn 0.5s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    @keyframes slideIn {
      from { transform: translateX(-100px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    .customer-card.active {
      border-color: #32CD32;
      border-width: 4px;
      box-shadow: 0 0 20px #32CD32;
      animation: glow 1s ease-in-out infinite;
    }
    
    .customer-card.urgent {
      border-color: #FF4500;
      animation: urgentGlow 0.5s ease-in-out infinite;
    }
    
    @keyframes glow {
      0%, 100% { box-shadow: 0 0 20px #32CD32; }
      50% { box-shadow: 0 0 30px #32CD32, 0 0 40px #32CD32; }
    }
    
    @keyframes urgentGlow {
      0%, 100% { 
        box-shadow: 0 0 20px #FF4500;
        transform: scale(1);
      }
      50% { 
        box-shadow: 0 0 35px #FF4500, 0 0 50px #FF4500;
        transform: scale(1.02);
      }
    }
    
    .customer-name {
      font-size: 16px;
      color: #8B4513;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: bold;
    }
    
    .customer-emoji {
      font-size: 24px;
      animation: bounce 1s ease-in-out infinite;
      transition: transform 0.3s;
    }
    
    .customer-card.active .customer-emoji {
      animation: activeBounce 0.5s ease-in-out infinite;
    }
    
    @keyframes activeBounce {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(-8px) scale(1.1); }
    }
    
    .customer-card.urgent .customer-emoji {
      animation: urgentShake 0.3s ease-in-out infinite;
    }
    
    @keyframes urgentShake {
      0%, 100% { transform: translateX(0) rotate(0deg); }
      25% { transform: translateX(-3px) rotate(-5deg); }
      75% { transform: translateX(3px) rotate(5deg); }
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }
    
    .customer-mood {
      font-size: 20px;
      margin-left: auto;
      animation: moodPulse 1s ease-in-out infinite;
    }
    
    @keyframes moodPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }
    
    .order-list {
      background: rgba(255, 255, 255, 0.9);
      padding: 10px;
      border-radius: 8px;
      border: 2px solid #8B4513;
      margin-top: 8px;
    }
    
    .order-item {
      font-size: 14px;
      padding: 4px 8px;
      margin: 4px 0;
      background: #FFF8DC;
      border-radius: 6px;
      border-left: 3px solid #FF6B6B;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.3s;
    }
    
    .order-item.completed {
      background: #90EE90;
      border-left-color: #32CD32;
      text-decoration: line-through;
      opacity: 0.7;
    }
    
    .order-item.current {
      background: #FFD700;
      border-left-color: #FFA500;
      animation: currentPulse 0.8s ease-in-out infinite;
      font-weight: bold;
    }
    
    @keyframes currentPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .timer-bar {
      height: 10px;
      background: #ddd;
      border-radius: 8px;
      overflow: hidden;
      margin-top: 8px;
      border: 2px solid #000;
    }
    
    .timer-fill {
      height: 100%;
      background: linear-gradient(90deg, #32CD32, #FFD700, #FF6B6B);
      transition: width 0.1s linear;
      border-radius: 6px;
    }
    
    /* Cooking Station */
    .cooking-station {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }
    
    .burger-build {
      background: linear-gradient(135deg, #C0C0C0, #808080);
      border: 4px solid #404040;
      border-radius: 15px;
      padding: 20px;
      min-height: 200px;
      max-height: 300px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
      box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.5);
      overflow-y: auto;
      position: relative;
    }
    
    /* Grill marks background */
    .burger-build::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 18px,
        rgba(0, 0, 0, 0.3) 18px,
        rgba(0, 0, 0, 0.3) 20px
      );
      pointer-events: none;
      border-radius: 15px;
    }
    
    .burger-build.cooking {
      animation: grillHeat 2s ease-in-out infinite;
    }
    
    @keyframes grillHeat {
      0%, 100% { box-shadow: inset 0 0 30px rgba(255, 69, 0, 0.3), 0 0 20px rgba(255, 69, 0, 0.2); }
      50% { box-shadow: inset 0 0 40px rgba(255, 69, 0, 0.5), 0 0 30px rgba(255, 69, 0, 0.3); }
    }
    
    /* Steam effects */
    .steam {
      position: absolute;
      bottom: 20px;
      width: 4px;
      height: 30px;
      background: linear-gradient(to top, rgba(255, 255, 255, 0.6), transparent);
      border-radius: 50%;
      animation: steamRise 2s ease-in infinite;
      pointer-events: none;
    }
    
    @keyframes steamRise {
      0% { transform: translateY(0) scale(1); opacity: 0.6; }
      100% { transform: translateY(-50px) scale(1.5); opacity: 0; }
    }
    
    .steam:nth-child(1) { left: 30%; animation-delay: 0s; }
    .steam:nth-child(2) { left: 50%; animation-delay: 0.5s; }
    .steam:nth-child(3) { left: 70%; animation-delay: 1s; }
    
    /* Sizzle particles */
    .sizzle {
      position: absolute;
      width: 3px;
      height: 3px;
      background: #FFD700;
      border-radius: 50%;
      animation: sizzlePop 1s ease-out infinite;
      pointer-events: none;
      box-shadow: 0 0 5px #FFD700;
    }
    
    @keyframes sizzlePop {
      0% { transform: translateY(0) scale(1); opacity: 1; }
      100% { transform: translateY(-20px) scale(0); opacity: 0; }
    }
    
    .burger-ingredient {
      width: 180px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: bold;
      border: 3px solid #000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      animation: placeIngredient 0.3s ease;
      position: relative;
      flex-shrink: 0;
      z-index: 1;
    }
    
    /* Shine effect on ingredients */
    .burger-ingredient::after {
      content: '';
      position: absolute;
      top: 5px;
      left: 20%;
      right: 20%;
      height: 40%;
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), transparent);
      border-radius: 50%;
    }
    
    @keyframes placeIngredient {
      0% { 
        transform: scale(0) rotate(180deg) translateY(-50px); 
        opacity: 0; 
      }
      60% {
        transform: scale(1.1) rotate(0deg) translateY(0);
      }
      100% { 
        transform: scale(1) rotate(0deg) translateY(0); 
        opacity: 1; 
      }
    }
    
    .ingredient-bun-bottom { background: linear-gradient(135deg, #DEB887, #D2691E); }
    .ingredient-patty { background: linear-gradient(135deg, #8B4513, #654321); color: #fff; }
    .ingredient-cheese { background: linear-gradient(135deg, #FFD700, #FFA500); }
    .ingredient-lettuce { background: linear-gradient(135deg, #90EE90, #32CD32); }
    .ingredient-tomato { background: linear-gradient(135deg, #FF6347, #DC143C); color: #fff; }
    .ingredient-pickles { background: linear-gradient(135deg, #9ACD32, #6B8E23); }
    .ingredient-onion { background: linear-gradient(135deg, #FFE4E1, #FFC0CB); }
    .ingredient-bun-top { 
      background: linear-gradient(135deg, #DEB887, #D2691E);
      border-radius: 50% 50% 40% 40%;
      position: relative;
    }
    
    .ingredient-bun-top::before {
      content: '';
      position: absolute;
      top: 4px;
      left: 50%;
      transform: translateX(-50%);
      width: 15px;
      height: 15px;
      background: #FFE4B5;
      border-radius: 50%;
      border: 2px solid #000;
    }
    
    /* Plate under complete burger */
    .burger-plate {
      width: 220px;
      height: 15px;
      background: linear-gradient(135deg, #FFFAFA, #F0F0F0);
      border-radius: 50%;
      border: 3px solid #000;
      margin-top: 10px;
      box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
      animation: plateAppear 0.3s ease;
      flex-shrink: 0;
      position: relative;
      z-index: 0;
    }
    
    .burger-plate::after {
      content: '';
      position: absolute;
      top: -2px;
      left: 10%;
      right: 10%;
      height: 50%;
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), transparent);
      border-radius: 50%;
    }
    
    @keyframes plateAppear {
      from { transform: scale(0); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    
    /* Ingredient Buttons */
    .ingredient-buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-top: 15px;
    }
    
    .ingredient-btn {
      background: linear-gradient(135deg, #4CAF50, #2E7D32);
      border: 3px solid #8BC34A;
      border-radius: 12px;
      padding: 12px 8px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .ingredient-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.4);
      transform: translate(-50%, -50%);
      transition: width 0.4s, height 0.4s;
    }
    
    .ingredient-btn:hover::before {
      width: 200px;
      height: 200px;
    }
    
    .ingredient-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 20px rgba(76, 175, 80, 0.5);
      border-color: #FFD700;
    }
    
    .ingredient-btn:active {
      transform: translateY(-1px) scale(1.02);
    }
    
    .ingredient-icon {
      font-size: 32px;
      margin-bottom: 6px;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }
    
    .ingredient-name {
      font-size: 12px;
      color: #fff;
      text-shadow: 1px 1px 0 #000;
      font-weight: bold;
    }
    
    /* Action Buttons */
    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    
    .action-btn {
      flex: 1;
      padding: 15px;
      border: none;
      border-radius: 12px;
      font-family: 'Krabby Patty', Arial, sans-serif;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      text-shadow: 2px 2px 0 #000;
    }
    
    .serve-btn {
      background: linear-gradient(135deg, #32CD32, #228B22);
      color: white;
      border: 3px solid #90EE90;
    }
    
    .serve-btn:hover:not(:disabled) {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 20px rgba(50, 205, 50, 0.5);
    }
    
    .serve-btn:disabled {
      background: #808080;
      cursor: not-allowed;
      opacity: 0.5;
    }
    
    .clear-btn {
      background: linear-gradient(135deg, #FF6B6B, #DC143C);
      color: white;
      border: 3px solid #FFB6C1;
    }
    
    .clear-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 20px rgba(220, 20, 60, 0.5);
    }
    
    /* Stats Panel */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }
    
    .stat-box {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      border: 3px solid #FF8C00;
      border-radius: 12px;
      padding: 12px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    .stat-label {
      font-size: 12px;
      color: #8B4513;
      margin-bottom: 6px;
      font-weight: bold;
    }
    
    .stat-value {
      font-size: 24px;
      color: #fff;
      text-shadow: 2px 2px 0 #8B4513;
      font-weight: bold;
    }
    
    /* Mr. Krabs Panel */
    .krabs-panel {
      text-align: center;
    }
    
    .krabs-emoji {
      font-size: 60px;
      animation: krabsHappy 2s ease-in-out infinite;
    }
    
    @keyframes krabsHappy {
      0%, 100% { transform: scale(1) rotate(0deg); }
      50% { transform: scale(1.1) rotate(5deg); }
    }
    
    .krabs-speech {
      background: linear-gradient(135deg, #FFE4E1, #FFB6C1);
      border: 3px solid #FF69B4;
      border-radius: 15px;
      padding: 12px;
      margin-top: 15px;
      font-size: 14px;
      color: #8B0000;
      text-shadow: 1px 1px 0 #fff;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      position: relative;
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .krabs-speech::before {
      content: '';
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 12px solid transparent;
      border-right: 12px solid transparent;
      border-bottom: 12px solid #FF69B4;
    }
    
    /* Menu Screen */
    .menu-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(180deg, #FF6B6B, #DC143C);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .menu-screen.hidden {
      display: none;
    }
    
    .menu-title {
      font-size: 72px;
      color: #FFD700;
      text-shadow: 5px 5px 0 #000;
      margin-bottom: 20px;
      animation: titleBounce 1s infinite;
    }
    
    @keyframes titleBounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }
    
    .menu-subtitle {
      font-size: 32px;
      color: #fff;
      text-shadow: 3px 3px 0 #000;
      margin-bottom: 40px;
    }
    
    .start-btn {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      border: 6px solid #FF8C00;
      color: #8B4513;
      padding: 30px 60px;
      font-size: 42px;
      cursor: pointer;
      border-radius: 20px;
      font-family: 'Krabby Patty', Arial, sans-serif;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      transition: all 0.3s;
      text-shadow: 2px 2px 0 #fff;
    }
    
    .start-btn:hover {
      transform: translateY(-10px) scale(1.1);
      box-shadow: 0 15px 40px rgba(255, 165, 0, 0.6);
    }
    
    /* Game Over Screen */
    .game-over-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .game-over-screen.show {
      display: flex;
      animation: fadeIn 0.5s;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .game-over-title {
      font-size: 64px;
      color: #FF6B6B;
      text-shadow: 5px 5px 0 #000;
      margin-bottom: 30px;
      animation: shake 0.5s;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    
    .final-stats {
      background: rgba(255, 255, 255, 0.1);
      border: 5px solid #FFD700;
      border-radius: 20px;
      padding: 40px;
      margin-bottom: 30px;
    }
    
    .final-stat {
      font-size: 28px;
      color: #FFD700;
      margin: 15px 0;
      text-shadow: 2px 2px 0 #000;
    }
    
    .back-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      background: linear-gradient(135deg, rgba(139, 69, 19, 0.95), rgba(101, 67, 33, 0.95));
      border: 3px solid #ffcc00;
      color: #ffcc00;
      padding: 12px 24px;
      font-family: 'Krabby Patty', Arial, sans-serif;
      font-size: 18px;
      cursor: pointer;
      border-radius: 10px;
      text-decoration: none;
      z-index: 100;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3);
      transition: all 0.3s;
    }
    
    .back-btn:hover {
      transform: scale(1.05);
    }
    
    /* Particles */
    .particle {
      position: fixed;
      pointer-events: none;
      animation: particleFloat 1s ease-out forwards;
      font-size: 32px;
      z-index: 1000;
    }
    
    @keyframes particleFloat {
      0% { transform: translateY(0) scale(1) rotate(0deg); opacity: 1; }
      100% { transform: translateY(-100px) scale(1.5) rotate(360deg); opacity: 0; }
    }
    
    /* Score Popup */
    .score-popup {
      position: fixed;
      font-size: 48px;
      font-weight: bold;
      color: #FFD700;
      text-shadow: 3px 3px 0 #000, 0 0 20px #FFD700;
      pointer-events: none;
      animation: scoreRise 1.5s ease-out forwards;
      z-index: 1001;
    }
    
    @keyframes scoreRise {
      0% { 
        transform: translateY(0) scale(0.5); 
        opacity: 0; 
      }
      20% {
        opacity: 1;
        transform: translateY(-20px) scale(1.2);
      }
      100% { 
        transform: translateY(-100px) scale(1); 
        opacity: 0; 
      }
    }
    
    /* Sound effect visual */
    .sound-effect {
      position: fixed;
      font-size: 64px;
      pointer-events: none;
      animation: soundBurst 0.6s ease-out forwards;
      z-index: 1001;
      filter: drop-shadow(0 0 10px currentColor);
    }
    
    @keyframes soundBurst {
      0% { 
        transform: scale(0) rotate(0deg); 
        opacity: 1; 
      }
      50% {
        transform: scale(1.2) rotate(180deg);
        opacity: 1;
      }
      100% { 
        transform: scale(0.8) rotate(360deg); 
        opacity: 0; 
      }
    }
    
    .combo-text {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 72px;
      color: #FFD700;
      text-shadow: 4px 4px 0 #000, 0 0 30px #FFD700;
      pointer-events: none;
      animation: comboPopup 1s ease-out forwards;
      z-index: 1001;
    }
    
    @keyframes comboPopup {
      0% { 
        transform: translate(-50%, -50%) scale(0) rotate(-180deg); 
        opacity: 0; 
      }
      30% { 
        transform: translate(-50%, -50%) scale(1.3) rotate(0deg); 
        opacity: 1; 
      }
      70% {
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
        opacity: 1;
      }
      100% { 
        transform: translate(-50%, -50%) scale(0.8) rotate(0deg); 
        opacity: 0; 
      }
    }
    
    /* Success flash */
    .success-flash {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(50, 205, 50, 0.3);
      pointer-events: none;
      animation: flash 0.4s ease-out;
      z-index: 999;
    }
    
    @keyframes flash {
      0%, 100% { opacity: 0; }
      50% { opacity: 1; }
    }
    
    /* Fail shake */
    .fail-shake {
      animation: shake 0.5s ease-in-out;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-10px); }
      40%, 80% { transform: translateX(10px); }
    }
    
    @media (max-width: 1200px) {
      .game-container {
        flex-direction: column;
        overflow-y: auto;
        height: auto;
        padding: 10px;
      }
      
      .left-section, .center-section, .right-section {
        flex: none;
        width: 100%;
        max-height: none;
      }
      
      .left-section {
        order: 2;
      }
      
      .center-section {
        order: 1;
      }
      
      .right-section {
        order: 3;
      }
      
      .ingredient-buttons {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
      }
      
      .ingredient-btn {
        padding: 10px 6px;
      }
      
      .ingredient-icon {
        font-size: 28px;
        margin-bottom: 4px;
      }
      
      .ingredient-name {
        font-size: 10px;
      }
      
      .burger-build {
        max-height: 250px;
        min-height: 180px;
        padding: 15px;
      }
      
      .burger-ingredient {
        width: 160px;
        height: 30px;
        font-size: 16px;
      }
      
      .customer-card {
        padding: 10px;
      }
      
      .customer-name {
        font-size: 14px;
      }
      
      .customer-emoji {
        font-size: 20px;
      }
      
      .order-item {
        font-size: 12px;
        padding: 3px 6px;
      }
      
      .stat-value {
        font-size: 20px;
      }
      
      .stat-label {
        font-size: 11px;
      }
      
      .krabs-emoji {
        font-size: 50px;
      }
      
      .krabs-speech {
        font-size: 12px;
        padding: 10px;
        min-height: 50px;
      }
      
      .action-btn {
        font-size: 16px;
        padding: 12px;
      }
      
      .panel-title {
        font-size: 18px;
      }
    }
    
    @media (max-width: 768px) {
      body {
        overflow-y: auto;
      }
      
      .game-container {
        padding: 5px;
        gap: 10px;
      }
      
      .panel {
        padding: 12px;
        border-width: 3px;
      }
      
      .ingredient-buttons {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
      }
      
      .ingredient-btn {
        padding: 15px 10px;
      }
      
      .ingredient-icon {
        font-size: 36px;
        margin-bottom: 8px;
      }
      
      .ingredient-name {
        font-size: 13px;
      }
      
      .burger-build {
        min-height: 200px;
        max-height: 280px;
      }
      
      .burger-ingredient {
        width: 140px;
        height: 28px;
        font-size: 14px;
      }
      
      .action-buttons {
        flex-direction: column;
        gap: 10px;
      }
      
      .action-btn {
        width: 100%;
        font-size: 18px;
        padding: 15px;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
      }
      
      .stat-box {
        padding: 10px;
      }
      
      .stat-value {
        font-size: 22px;
      }
      
      .menu-title {
        font-size: 48px;
      }
      
      .menu-subtitle {
        font-size: 22px;
      }
      
      .start-btn {
        font-size: 32px;
        padding: 20px 40px;
      }
      
      .game-over-title {
        font-size: 48px;
      }
      
      .final-stats {
        padding: 25px;
      }
      
      .final-stat {
        font-size: 20px;
      }
    }
    
    @media (max-width: 480px) {
      .panel-title {
        font-size: 16px;
        margin-bottom: 10px;
        padding-bottom: 6px;
      }
      
      .customer-queue {
        max-height: 400px;
        overflow-y: auto;
      }
      
      .ingredient-btn {
        padding: 12px 8px;
      }
      
      .ingredient-icon {
        font-size: 32px;
      }
      
      .ingredient-name {
        font-size: 11px;
      }
      
      .burger-ingredient {
        width: 120px;
        height: 25px;
        font-size: 12px;
      }
      
      .menu-title {
        font-size: 36px;
      }
      
      .menu-subtitle {
        font-size: 18px;
      }
      
      .start-btn {
        font-size: 24px;
        padding: 15px 30px;
      }
    }
  </style>
</head>
<body>
  <a href="index.html" class="back-btn">‚óÄ MENU</a>
  
  <!-- Menu Screen -->
  <div class="menu-screen" id="menuScreen">
    <div class="menu-title">üçî KRUSTY KRAB ORDER RUSH üçî</div>
    <div class="menu-subtitle">Cook fast! Serve customers! Make money!</div>
    <button class="start-btn" onclick="startGame()">I'M READY!</button>
  </div>
  
  <!-- Game Over Screen -->
  <div class="game-over-screen" id="gameOverScreen">
    <div class="game-over-title">TIME'S UP!</div>
    <div class="final-stats">
      <div class="final-stat">Orders Served: <span id="finalOrders">0</span></div>
      <div class="final-stat">Money Earned: $<span id="finalMoney">0</span></div>
      <div class="final-stat">Perfect Orders: <span id="finalPerfect">0</span></div>
      <div class="final-stat">Best Combo: <span id="finalCombo">0</span>x</div>
    </div>
    <button class="start-btn" onclick="startGame()">COOK AGAIN!</button>
  </div>
  
  <!-- Game Container -->
  <div class="game-container" id="gameContainer" style="display: none;">
    <!-- Left Section: Customer Queue -->
    <div class="left-section">
      <div class="panel customer-queue">
        <div class="panel-title">üë• CUSTOMER QUEUE</div>
        <div id="customerList"></div>
      </div>
    </div>
    
    <!-- Center Section: Cooking Station -->
    <div class="center-section">
      <div class="panel cooking-station">
        <div class="panel-title">üç≥ COOKING STATION</div>
        <div class="burger-build" id="burgerBuild">
          <div style="font-size: 48px; color: #666;">üçî</div>
          <div style="font-size: 24px; color: #666;">Click ingredients below!</div>
        </div>
        
        <div class="ingredient-buttons">
          <div class="ingredient-btn" onclick="addIngredient('bun-bottom')">
            <div class="ingredient-icon">üçû</div>
            <div class="ingredient-name">BOTTOM BUN</div>
          </div>
          <div class="ingredient-btn" onclick="addIngredient('patty')">
            <div class="ingredient-icon">ü•©</div>
            <div class="ingredient-name">PATTY</div>
          </div>
          <div class="ingredient-btn" onclick="addIngredient('cheese')">
            <div class="ingredient-icon">üßÄ</div>
            <div class="ingredient-name">CHEESE</div>
          </div>
          <div class="ingredient-btn" onclick="addIngredient('lettuce')">
            <div class="ingredient-icon">ü•¨</div>
            <div class="ingredient-name">LETTUCE</div>
          </div>
          <div class="ingredient-btn" onclick="addIngredient('tomato')">
            <div class="ingredient-icon">üçÖ</div>
            <div class="ingredient-name">TOMATO</div>
          </div>
          <div class="ingredient-btn" onclick="addIngredient('pickles')">
            <div class="ingredient-icon">ü•í</div>
            <div class="ingredient-name">PICKLES</div>
          </div>
          <div class="ingredient-btn" onclick="addIngredient('onion')">
            <div class="ingredient-icon">üßÖ</div>
            <div class="ingredient-name">ONION</div>
          </div>
          <div class="ingredient-btn" onclick="addIngredient('bun-top')">
            <div class="ingredient-icon">üçû</div>
            <div class="ingredient-name">TOP BUN</div>
          </div>
        </div>
        
        <div class="action-buttons">
          <button class="action-btn serve-btn" id="serveBtn" onclick="serveOrder()">
            SERVE ORDER!
          </button>
          <button class="action-btn clear-btn" onclick="clearBurger()">
            CLEAR
          </button>
        </div>
      </div>
    </div>
    
    <!-- Right Section: Stats & Mr. Krabs -->
    <div class="right-section">
      <div class="panel">
        <div class="panel-title">üìä STATS</div>
        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-label">üí∞ Money</div>
            <div class="stat-value" id="money">$0</div>
          </div>
          <div class="stat-box">
            <div class="stat-label">üçî Served</div>
            <div class="stat-value" id="served">0</div>
          </div>
          <div class="stat-box">
            <div class="stat-label">‚è±Ô∏è Time</div>
            <div class="stat-value" id="timer">90</div>
          </div>
          <div class="stat-box">
            <div class="stat-label">üî• Combo</div>
            <div class="stat-value" id="combo">0x</div>
          </div>
        </div>
      </div>
      
      <div class="panel krabs-panel">
        <div class="krabs-emoji">ü¶Ä</div>
        <div class="krabs-speech" id="krabsSpeech">
          Get to work, boy! Me money ain't gonna make itself!
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Game State
    let customers = [];
    let currentBurger = [];
    let money = 0;
    let ordersServed = 0;
    let perfectOrders = 0;
    let currentCombo = 0;
    let bestCombo = 0;
    let gameTime = 90;
    let gameRunning = false;
    let timerInterval = null;
    let customerInterval = null;
    
    // Customer names and emojis
    const customerPool = [
      { name: 'SpongeBob', emoji: 'üßΩ' },
      { name: 'Patrick', emoji: '‚≠ê' },
      { name: 'Squidward', emoji: 'üêô' },
      { name: 'Sandy', emoji: 'üêøÔ∏è' },
      { name: 'Pearl', emoji: 'üêã' },
      { name: 'Larry', emoji: 'ü¶û' },
      { name: 'Mrs. Puff', emoji: 'üê°' },
      { name: 'Bubble Bass', emoji: 'üêü' },
      { name: 'Plankton', emoji: 'ü¶†' }
    ];
    
    // Ingredient mappings
    const ingredientMap = {
      'bun-bottom': 'üçû Bottom Bun',
      'patty': 'ü•© Patty',
      'cheese': 'üßÄ Cheese',
      'lettuce': 'ü•¨ Lettuce',
      'tomato': 'üçÖ Tomato',
      'pickles': 'ü•í Pickles',
      'onion': 'üßÖ Onion',
      'bun-top': 'üçû Top Bun'
    };
    
    // Mr. Krabs quotes
    const krabsQuotes = {
      perfect: [
        "Excellent work, boy! That's me money!",
        "Perfect! Just like me mother used to make!",
        "Beautiful! Keep 'em coming!",
        "Now THAT'S a Krabby Patty!",
        "Me money! Me beautiful money!"
      ],
      good: [
        "Good enough, lad!",
        "Not bad, not bad at all!",
        "Keep up the pace!",
        "That'll do, boy!"
      ],
      wrong: [
        "THAT'S NOT WHAT THEY ORDERED!",
        "Are ye trying to bankrupt me?!",
        "Pay attention to the order!",
        "Me money! Me precious money!",
        "Get it right next time!"
      ],
      slow: [
        "Faster, boy! Time is money!",
        "Pick up the pace!",
        "Me customers are waiting!",
        "Speed it up, lad!"
      ]
    };
    
    function startGame() {
      // Reset game state
      customers = [];
      currentBurger = [];
      money = 0;
      ordersServed = 0;
      perfectOrders = 0;
      currentCombo = 0;
      bestCombo = 0;
      gameTime = 90;
      gameRunning = true;
      
      // Clear any existing timers
      if (timerInterval) clearInterval(timerInterval);
      if (customerInterval) clearInterval(customerInterval);
      
      // Hide menu, show game
      document.getElementById('menuScreen').classList.add('hidden');
      document.getElementById('gameOverScreen').classList.remove('show');
      document.getElementById('gameContainer').style.display = 'flex';
      
      // Update displays
      updateStats();
      clearBurger();
      
      // Start timers
      timerInterval = setInterval(updateTimer, 1000);
      
      // Spawn first customer immediately
      spawnCustomer();
      
      // Then spawn customers every 10-15 seconds
      customerInterval = setInterval(() => {
        if (customers.length < 4) {
          spawnCustomer();
        }
      }, Math.random() * 5000 + 10000);
      
      sayKrabs("Let's make some money!");
    }
    
    function spawnCustomer() {
      if (!gameRunning) return;
      
      const customer = customerPool[Math.floor(Math.random() * customerPool.length)];
      const numIngredients = Math.floor(Math.random() * 3) + 4; // 4-6 ingredients
      
      // Generate random order (always: bottom bun ‚Üí patty ‚Üí random ingredients ‚Üí top bun)
      const middleIngredients = ['cheese', 'lettuce', 'tomato', 'pickles', 'onion'];
      const order = ['bun-bottom', 'patty']; // ALWAYS start with bun and patty
      
      // Add random middle ingredients
      for (let i = 0; i < numIngredients - 3; i++) { // -3 because we have bun, patty, and top bun
        const ingredient = middleIngredients[Math.floor(Math.random() * middleIngredients.length)];
        order.push(ingredient);
      }
      
      order.push('bun-top');
      
      const customerId = Date.now() + Math.random(); // Ensure unique ID
      
      customers.push({
        id: customerId,
        name: customer.name,
        emoji: customer.emoji,
        order: order,
        timeLeft: 35,
        maxTime: 35
      });
      
      updateCustomerDisplay();
      
      // Start customer timer
      const customerTimer = setInterval(() => {
        if (!gameRunning) {
          clearInterval(customerTimer);
          return;
        }
        
        const customer = customers.find(c => c.id === customerId);
        if (!customer) {
          clearInterval(customerTimer);
          return;
        }
        
        customer.timeLeft--;
        
        if (customer.timeLeft <= 0) {
          // Customer left angry
          const index = customers.findIndex(c => c.id === customerId);
          if (index !== -1) {
            customers.splice(index, 1);
            updateCustomerDisplay();
            sayKrabs(krabsQuotes.slow[Math.floor(Math.random() * krabsQuotes.slow.length)]);
            currentCombo = 0;
            updateStats();
          }
          clearInterval(customerTimer);
        } else {
          updateCustomerDisplay();
        }
      }, 1000);
    }
    
    function updateCustomerDisplay() {
      const list = document.getElementById('customerList');
      list.innerHTML = '';
      
      customers.forEach((customer, index) => {
        const card = document.createElement('div');
        let cardClass = 'customer-card';
        if (index === 0) cardClass += ' active';
        if (customer.timeLeft <= 10) cardClass += ' urgent';
        card.className = cardClass;
        
        const timePercent = (customer.timeLeft / customer.maxTime) * 100;
        
        // Determine customer mood based on time left
        let mood = 'üòä'; // Happy
        if (customer.timeLeft <= 10) mood = 'üò∞'; // Worried
        if (customer.timeLeft <= 5) mood = 'üò°'; // Angry
        
        // Show order progress for active customer
        let orderHTML = '';
        if (index === 0 && currentBurger.length > 0) {
          orderHTML = customer.order.map((ing, idx) => {
            let itemClass = 'order-item';
            if (idx < currentBurger.length) {
              // Check if this ingredient matches
              if (currentBurger[idx] === ing) {
                itemClass += ' completed';
              }
            }
            if (idx === currentBurger.length) {
              itemClass += ' current';
            }
            return `<div class="${itemClass}">${ingredientMap[ing]}</div>`;
          }).join('');
        } else {
          orderHTML = customer.order.map(ing => 
            `<div class="order-item">${ingredientMap[ing]}</div>`
          ).join('');
        }
        
        card.innerHTML = `
          <div class="customer-name">
            <span class="customer-emoji">${customer.emoji}</span>
            <strong>${customer.name}</strong>
            <span class="customer-mood">${mood}</span>
          </div>
          <div class="order-list">
            ${orderHTML}
          </div>
          <div class="timer-bar">
            <div class="timer-fill" style="width: ${timePercent}%"></div>
          </div>
        `;
        
        list.appendChild(card);
      });
    }
    
    function addIngredient(ingredient) {
      if (!gameRunning) return;
      
      currentBurger.push(ingredient);
      updateBurgerDisplay();
      
      // Enable serve button when we have at least 3 ingredients
      document.getElementById('serveBtn').disabled = currentBurger.length < 3;
    }
    
    function updateBurgerDisplay() {
      const build = document.getElementById('burgerBuild');
      build.innerHTML = '';
      
      if (currentBurger.length === 0) {
        build.classList.remove('cooking');
        build.innerHTML = `
          <div style="font-size: 48px; color: #333;">üç≥</div>
          <div style="font-size: 20px; color: #333; text-shadow: 1px 1px 0 rgba(255,255,255,0.5);">Click ingredients below!</div>
        `;
        return;
      }
      
      // Add cooking class for grill effect
      build.classList.add('cooking');
      
      // Add steam effects
      for (let i = 0; i < 3; i++) {
        const steam = document.createElement('div');
        steam.className = 'steam';
        build.appendChild(steam);
      }
      
      // Add sizzle effects if there's a patty
      if (currentBurger.includes('patty')) {
        for (let i = 0; i < 5; i++) {
          const sizzle = document.createElement('div');
          sizzle.className = 'sizzle';
          sizzle.style.left = (20 + Math.random() * 60) + '%';
          sizzle.style.bottom = (30 + Math.random() * 30) + 'px';
          sizzle.style.animationDelay = (Math.random() * 1) + 's';
          build.appendChild(sizzle);
        }
      }
      
      // Show burger being built (reverse order so top bun is on top)
      [...currentBurger].reverse().forEach(ingredient => {
        const div = document.createElement('div');
        div.className = 'burger-ingredient ingredient-' + ingredient;
        div.textContent = ingredientMap[ingredient];
        build.appendChild(div);
      });
      
      // Add plate if burger has top bun
      if (currentBurger[currentBurger.length - 1] === 'bun-top') {
        const plate = document.createElement('div');
        plate.className = 'burger-plate';
        build.appendChild(plate);
      }
    }
    
    function clearBurger() {
      currentBurger = [];
      updateBurgerDisplay();
      document.getElementById('serveBtn').disabled = true;
    }
    
    function serveOrder() {
      if (!gameRunning || customers.length === 0 || currentBurger.length === 0) return;
      
      const customer = customers[0];
      
      // Check if order matches exactly
      const correct = JSON.stringify(currentBurger) === JSON.stringify(customer.order);
      
      if (correct) {
        // Perfect order!
        const baseReward = 10;
        const timeBonus = Math.floor(customer.timeLeft / 2);
        const comboBonus = currentCombo * 2;
        const totalReward = baseReward + timeBonus + comboBonus;
        
        money += totalReward;
        ordersServed++;
        perfectOrders++;
        currentCombo++;
        
        if (currentCombo > bestCombo) bestCombo = currentCombo;
        
        // Remove customer
        const customerId = customers[0].id;
        customers.shift();
        
        // Visual effects
        flashScreen(true);
        createParticles('üí∞', 8);
        createParticles('‚ú®', 6);
        showScorePopup(totalReward, window.innerWidth / 2, window.innerHeight / 3);
        
        // Sound effect
        if (timeBonus > 10) {
          showSoundEffect('‚ö°', '#FFD700'); // Fast serve!
        } else {
          showSoundEffect('üîî', '#32CD32'); // Order up!
        }
        
        sayKrabs(krabsQuotes.perfect[Math.floor(Math.random() * krabsQuotes.perfect.length)]);
        
        if (currentCombo >= 3) {
          showCombo(currentCombo);
        }
        
      } else {
        // Wrong order!
        money = Math.max(0, money - 5);
        currentCombo = 0;
        
        // Remove customer (they leave angry)
        customers.shift();
        
        // Visual effects
        flashScreen(false);
        createParticles('üí¢', 6);
        createParticles('üò°', 4);
        showSoundEffect('‚ùå', '#FF0000');
        
        // Shake the screen
        const gameContainer = document.getElementById('gameContainer');
        gameContainer.classList.add('fail-shake');
        setTimeout(() => gameContainer.classList.remove('fail-shake'), 500);
        
        sayKrabs(krabsQuotes.wrong[Math.floor(Math.random() * krabsQuotes.wrong.length)]);
      }
      
      clearBurger();
      updateCustomerDisplay();
      updateStats();
    }
    
    function updateTimer() {
      if (!gameRunning) return;
      
      gameTime--;
      updateStats();
      
      if (gameTime <= 0) {
        endGame();
      }
    }
    
    function updateStats() {
      document.getElementById('money').textContent = '$' + money;
      document.getElementById('served').textContent = ordersServed;
      document.getElementById('timer').textContent = gameTime;
      document.getElementById('combo').textContent = currentCombo + 'x';
    }
    
    function sayKrabs(quote) {
      document.getElementById('krabsSpeech').textContent = quote;
    }
    
    function createParticles(emoji, count = 10) {
      for (let i = 0; i < count; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.textContent = emoji;
        particle.style.left = (Math.random() * window.innerWidth) + 'px';
        particle.style.top = (Math.random() * window.innerHeight) + 'px';
        document.body.appendChild(particle);
        
        setTimeout(() => particle.remove(), 1000);
      }
    }
    
    function showScorePopup(amount, x, y) {
      const popup = document.createElement('div');
      popup.className = 'score-popup';
      popup.textContent = '+$' + amount;
      popup.style.left = x + 'px';
      popup.style.top = y + 'px';
      document.body.appendChild(popup);
      
      setTimeout(() => popup.remove(), 1500);
    }
    
    function showSoundEffect(emoji, color = '#FFD700') {
      const sound = document.createElement('div');
      sound.className = 'sound-effect';
      sound.textContent = emoji;
      sound.style.color = color;
      sound.style.left = (window.innerWidth / 2 - 32) + 'px';
      sound.style.top = (window.innerHeight / 2 - 32) + 'px';
      document.body.appendChild(sound);
      
      setTimeout(() => sound.remove(), 600);
    }
    
    function flashScreen(success = true) {
      const flash = document.createElement('div');
      flash.className = success ? 'success-flash' : 'fail-flash';
      if (!success) {
        flash.style.background = 'rgba(255, 0, 0, 0.3)';
        flash.style.animation = 'flash 0.4s ease-out';
      }
      document.body.appendChild(flash);
      
      setTimeout(() => flash.remove(), 400);
    }
    
    function showCombo(combo) {
      const comboText = document.createElement('div');
      comboText.className = 'combo-text';
      comboText.textContent = combo + 'x COMBO! üî•';
      document.body.appendChild(comboText);
      
      setTimeout(() => comboText.remove(), 1000);
    }
    
    function endGame() {
      gameRunning = false;
      clearInterval(timerInterval);
      clearInterval(customerInterval);
      
      // Show game over screen
      document.getElementById('finalOrders').textContent = ordersServed;
      document.getElementById('finalMoney').textContent = money;
      document.getElementById('finalPerfect').textContent = perfectOrders;
      document.getElementById('finalCombo').textContent = bestCombo;
      
      document.getElementById('gameOverScreen').classList.add('show');
      document.getElementById('gameContainer').style.display = 'none';
      
      // Auto-show leaderboard
      setTimeout(() => showLeaderboardModal('krusty-krab-rush', 'Krusty Krab Order Rush', money), 1000);
    }
  </script>
</body>
</html>